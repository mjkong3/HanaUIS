<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ateam.mapper.AdProfessorMapper">

	
	<!-- list grd에 목록 생성 -->
	<select id="selectAdProList" parameterType="java.util.Map" resultType="java.util.Map">
	
		SELECT PROFESSOR_ID, NAME, PHONE, EMAIL, GENDER, ADDRESS, STATUS, ADMIN_CODE, DEPARTMENT_CODE, REGDATE, 0 AS 'CHECK'
		FROM PROFESSOR
		WHERE 1=1
		
		<if test="SEARCH_WORD != null">
			<if test="SEARCH_TYPE == 'ALL'"> 
				AND (PROFESSOR_ID LIKE CONCAT('%', #{SEARCH_WORD}, '%')
				OR NAME LIKE CONCAT('%', #{SEARCH_WORD}, '%')
				OR PHONE LIKE CONCAT('%', #{SEARCH_WORD}, '%')
				OR EMAIL LIKE CONCAT('%', #{SEARCH_WORD}, '%')
				OR ADDRESS LIKE CONCAT('%', #{SEARCH_WORD}, '%')
				OR STATUS LIKE CONCAT('%', #{SEARCH_WORD}, '%')
				OR GENDER LIKE CONCAT('%', #{SEARCH_WORD}, '%')
				OR ADMIN_CODE LIKE CONCAT('%', #{SEARCH_WORD}, '%')
				OR REGDATE LIKE CONCAT('%', #{SEARCH_WORD}, '%'))
			</if>
			<if test="SEARCH_TYPE == 'PROFESSOR_ID'">
				AND PROFESSOR_ID LIKE CONCAT('%', #{SEARCH_WORD}, '%')
			</if>
			<if test="SEARCH_TYPE == 'NAME'">
				AND NAME LIKE CONCAT('%', #{SEARCH_WORD}, '%')
			</if>
			<if test="SEARCH_TYPE == 'PHONE'">
				AND PHONE LIKE CONCAT('%', #{SEARCH_WORD}, '%')
			</if>
			<if test="SEARCH_TYPE == 'EMAIL'">
				AND EMAIL LIKE CONCAT('%', #{SEARCH_WORD}, '%')
			</if>
			<if test="SEARCH_TYPE == 'ADDRESS'">
				AND ADDRESS LIKE CONCAT('%', #{SEARCH_WORD}, '%')
			</if>
			<if test="SEARCH_TYPE == 'STATUS'">
				AND STATUS LIKE CONCAT('%', #{SEARCH_WORD}, '%')
			</if>
			<if test="SEARCH_TYPE == 'GENDER'">
				AND GENDER LIKE CONCAT('%', #{SEARCH_WORD}, '%')
			</if>
			<if test="SEARCH_TYPE == 'ADMIN_CODE'">
				AND ADMIN_CODE LIKE CONCAT('%', #{SEARCH_WORD}, '%')
			</if>
			<if test="SEARCH_TYPE == 'REGDATE'">
				AND REGDATE LIKE CONCAT('%', #{SEARCH_WORD}, '%')
			</if>
		</if>
		<if test="DEPARTMENT_CODE != 0">
			AND DEPARTMENT_CODE = #{DEPARTMENT_CODE}
		</if>
	</select>
	
	<!-- pro_id를 통해 기등록 - update / 미등록 - insert -->
	<select id="checkAdPro" parameterType="java.util.Map" resultType="Integer">
		
		SELECT COUNT(1)
		FROM PROFESSOR
		WHERE PROFESSOR_ID = #{PROFESSOR_ID}
	
	</select>
	
	<!-- 미등록시 insert문 실행 -->
	<insert id="insertAdPro" parameterType="java.util.Map">
		
		INSERT INTO PROFESSOR(
			PROFESSOR_ID,
			PASSWORD,
			NAME,
			PHONE,
			EMAIL,
			BIRTHDAY,
			GENDER,
			ADDRESS,
			STATUS,
			REGDATE,
			ADMIN_CODE,
			DEPARTMENT_CODE,
			PHOTO)
					 VALUES(
							#{PROFESSOR_ID},
							SHA2(#{PASSWORD}, 256),
							#{NAME},
							#{PHONE},
							#{EMAIL},
							#{BIRTHDAY},
							#{GENDER},
							#{ADDRESS},
							#{STATUS},
							#{REGDATE},
							#{ADMIN_CODE},
							#{DEPARTMENT_CODE},
							#{PHOTO}
							)
	
	</insert>
	
	<!-- 기등록시 update문 실행 -->
	<update id="updateAdPro" parameterType="java.util.Map">
	
		UPDATE PROFESSOR SET
					PASSWORD = SHA2(#{PASSWORD}, 256),
					NAME = #{NAME},
					PHONE = #{PHONE},
					EMAIL = #{EMAIL},
					BIRTHDAY = #{BIRTHDAY},
					GENDER = #{GENDER},
					ADDRESS = #{ADDRESS},
					STATUS = #{STATUS},
					REGDATE = #{REGDATE},
					ADMIN_CODE = #{ADMIN_CODE},
					DEPARTMENT_CODE = #{DEPARTMENT_CODE},
					PHOTO = #{PHOTO}
					WHERE PROFESSOR_ID = #{PROFESSOR_ID}
	
	</update>
	
	<!-- 상세보기용 교수정보 select -->
	<select id="selectAdProInfo" parameterType="java.util.Map" resultType="java.util.Map">
		
		SELECT PROFESSOR_ID, PASSWORD, NAME, PHONE, EMAIL, GENDER, ADDRESS, BIRTHDAY, STATUS, ADMIN_CODE, DEPARTMENT_CODE, REGDATE, PHOTO
		FROM PROFESSOR
		WHERE 1=1
		AND PROFESSOR_ID = #{ProId}
	
	</select>
	
	<!-- list grd에 체크된 값들 삭제처리 -->
	<delete id="deleteAdPro" parameterType="java.util.Map">
      
      DELETE FROM PROFESSOR
      WHERE PROFESSOR_ID = #{PROFESSOR_ID}
   
   </delete>
</mapper>